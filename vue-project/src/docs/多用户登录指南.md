# 多用户登录指南

## 🎯 系统概述

系统现在支持多用户登录，包含 **4个患者用户** 和 **4个医生用户**，分布在两个科室中。每个科室的医生只能查看本科室患者的医疗数据，实现了完整的数据隔离和权限控制。

## 👥 预设用户列表

### 患者用户 (4个)

| 姓名 | 科室 | 用户ID | 特点 |
|------|------|--------|------|
| 张三 | 心血管科 | `patient_cardio_001` | 心血管科患者 |
| 李四 | 心血管科 | `patient_cardio_002` | 心血管科患者 |
| 王五 | 呼吸内科 | `patient_respiratory_001` | 呼吸内科患者 |
| 赵六 | 呼吸内科 | `patient_respiratory_002` | 呼吸内科患者 |

### 医生用户 (4个)

| 姓名 | 科室 | 用户ID | 特点 |
|------|------|--------|------|
| 刘医生 | 心血管科 | `doctor_cardio_001` | 只能看心血管科数据 |
| 陈医生 | 心血管科 | `doctor_cardio_002` | 只能看心血管科数据 |
| 吴医生 | 呼吸内科 | `doctor_respiratory_001` | 只能看呼吸内科数据 |
| 周医生 | 呼吸内科 | `doctor_respiratory_002` | 只能看呼吸内科数据 |

## 🚪 登录方式

### 方式一：登录页面快捷登录（推荐）

1. 访问登录页面：`http://localhost:5173/login`
2. 在页面底部找到 **"预设用户快捷登录"** 区域
3. 选择任意用户直接登录：
   - **患者按钮**：蓝色按钮，显示 "姓名 (科室)"
   - **医生按钮**：绿色按钮，显示 "姓名 (科室)"
4. 点击后自动登录并跳转到对应页面

### 方式二：用户切换组件

如果你已经登录，可以使用 `UserSwitcher` 组件快速切换用户：

```vue
<template>
  <UserSwitcher />
</template>

<script>
import UserSwitcher from '@/components/UserSwitcher.vue'
</script>
```

### 方式三：编程方式切换

在浏览器控制台或代码中使用：

```javascript
// 引入mockBackend
import mockBackend from '@/services/mockBackend'

// 切换到心血管科患者张三
await mockBackend.switchUser('patient_cardio_001', 'patient')

// 切换到呼吸内科医生吴医生
await mockBackend.switchUser('doctor_respiratory_001', 'doctor')

// 获取所有用户列表
const users = await mockBackend.getAllUsers()
console.log('所有患者:', users.data.patients)
console.log('所有医生:', users.data.doctors)
```

## 🔒 权限验证

### 科室级数据隔离

- **医生权限**：每个医生只能查看本科室患者的医疗数据
- **患者权限**：每个患者只能查看和管理自己的数据
- **文件上传**：患者上传的文件自动标记为当前科室

### 测试科室隔离

1. **登录呼吸内科医生吴医生**，查看数据管理页面 → 只显示呼吸内科患者（王五、赵六）的数据
2. **切换到心血管科刘医生**，查看数据管理页面 → 只显示心血管科患者（张三、李四）的数据
3. **登录患者张三**，查看我的数据页面 → 只显示张三自己的数据

### 测试数据上传

1. **登录患者王五（呼吸内科）**
2. 上传一个医疗文件
3. **切换到呼吸内科医生吴医生** → 可以看到王五的文件
4. **切换到心血管科刘医生** → 看不到王五的文件

## 🛠️ 开发调试

### 重置所有数据

```javascript
// 清除所有localStorage数据并重新初始化
mockBackend.resetAllData()
```

### 查看当前用户

```javascript
// 在控制台查看当前登录用户
console.log('当前用户:', JSON.parse(localStorage.getItem('user')))
console.log('用户数据库:', JSON.parse(localStorage.getItem('mock_user_database')))
```

### 查看医疗文件

```javascript
// 查看所有医疗文件（带科室信息）
console.log('所有文件:', JSON.parse(localStorage.getItem('mock_medical_files')))
```

## 📱 页面路由

- **患者登录后** → `/patient/data` (我的数据页面)
- **医生登录后** → `/doctor/data` (数据管理页面)
- **登录页面** → `/login`
- **注册页面** → `/register`

## 🎨 界面预览

### 登录页面
- 显示所有预设用户的快捷登录按钮
- 患者用户为蓝色按钮
- 医生用户为绿色按钮
- 按科室分组显示

### 用户切换组件
- 下拉菜单显示所有用户
- 当前用户高亮显示
- 支持快速切换和退出登录

## 🔧 技术实现

- **多用户管理**：`mockBackend.ts` 中的 `UserDatabase` 结构
- **数据隔离**：基于 `departmentName` 字段进行科室级过滤
- **权限控制**：`getDoctorMedicalDataList()` 和 `getPatientMedicalFiles()` 函数
- **用户切换**：`switchUser()` 函数和相关UI组件

现在你可以使用任意预设用户登录系统，体验完整的多用户、多科室医疗数据管理功能！

## 🎯 快速开始

1. 启动项目：`npm run dev`
2. 访问：`http://localhost:5173/login`
3. 点击 **"张三 (心血管科)"** 按钮登录患者
4. 或点击 **"刘医生 (心血管科)"** 按钮登录医生
5. 体验数据上传、查看、授权等功能
6. 使用用户切换功能体验不同角色和科室的数据访问权限

享受多用户系统带来的完整功能体验！🚀
